<div class="formField"
     [ngClass]="{
      error: !!error || !!control?.errors,
      filled: filled !== undefined && filled !== false,
      touched: touched,
      disabled: disabled || (!!group && !radioInputRef.checked),
      radio: !!group || !!radioWrapper?.innerHTML?.trim()
     }">
  <!--  LABEL -->
  <label *ngIf="!!label" class="formField-label">{{label | translate}}</label>

  <div class="formField-row" [ngClass]="{focus: focus}">
    <!--  RADIO CHECK -->
    <span class="formField-radio">
      <span #radioWrapper><ng-content select="[radio]"></ng-content></span>
      <input [type]="!group ? 'hidden' : 'radio'"
             (change)="changeRadioInput({ref: radioInputRef, group: group})"
             [value]="value"
             [name]="group"
             #radioInputRef>
    </span>

    <!--  BASE INPUT -->
    <input #ref="preference-units"
           [set-units]="setUnits"
           [unit-types]="unitTypes"
           [unit-controls]="unitControls"
           [masterText-Keys]="masterTextKeys"
           [moduleGroupId]="moduleGroupId"
           [control]="control"
           #inputRef
           [type]="type"
           [required]="required"
           [disabled]="disabled || (!!group && !radioInputRef.checked)"
           [ngClass]="{filled: filled !== undefined && filled !== false}"
           (focusin)="focus = true"
           (focusout)="touched = true; focus = false;"
           (blur)="onTouched()"
           [ngModel]="value"
           (ngModelChange)="updateValue($event)"
           class="formField-input">

    <!--  UNIT -->
    <span class="formField-addon" *ngIf="ref?.preferences || unit">
      <span class="unitBefore"><ng-content select="[unitBefore]"></ng-content></span>
      <span *ngFor="let preference of ref?.preferences; let i = index;">
        {{i > 0 ? '/' : ''}}{{preference?.unitName}}
      </span>
      {{unit}}
      <span class="unitAfter"><ng-content select="[unitAfter]"></ng-content></span>
    </span>
  </div>

  <!--  ERROR/MESSAGE -->
  <span class="formField-message error" *ngIf="control?.errors; else messageTemplate">{{control?.errors | json}}</span>
  <ng-template #messageTemplate>
    <span class="formField-message" [ngClass]="{error: error}">{{error || message}}</span>
  </ng-template>
</div>
